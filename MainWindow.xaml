<Window x:Class="AwsSecurityAssessment.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="AWS Security Assessment Tool" Height="900" Width="1600"
        Background="{StaticResource BackgroundBrush}">
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0" Text="AWS Organization Security Assessment" 
                   FontSize="28" FontWeight="Bold" 
                   Foreground="{StaticResource PrimaryBrush}" 
                   Margin="0,0,0,20"/>

        <!-- Credentials Panel -->
        <GroupBox Grid.Row="1" Header="AWS Credentials" Margin="0,0,0,15" Padding="15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,10,10">
                    <Label Content="Access Key ID:"/>
                    <TextBox x:Name="AccessKeyIdTextBox" 
                             Text="{Binding AccessKeyId, UpdateSourceTrigger=PropertyChanged}"/>
                </StackPanel>

                <StackPanel Grid.Row="0" Grid.Column="1" Margin="0,0,10,10">
                    <Label Content="Secret Access Key:"/>
                    <PasswordBox x:Name="SecretAccessKeyPasswordBox"/>
                </StackPanel>

                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,10,10">
                    <Label Content="Region (optional):"/>
                    <TextBox x:Name="RegionTextBox" Text="us-east-1"/>
                </StackPanel>

                <StackPanel Grid.Row="1" Grid.Column="1" Margin="0,0,10,10">
                    <Label Content="Audit Role ARN:"/>
                    <TextBox x:Name="AuditRoleTextBox" 
                             Text="arn:aws:iam::ACCOUNT_ID:role/AuditRole"
                             ToolTip="Enter the full ARN of the audit role (e.g., arn:aws:iam::123456789012:role/AuditRole)"/>
                </StackPanel>

                <StackPanel Grid.Row="0" Grid.Column="2" Grid.RowSpan="2" Margin="10,0,0,0">
                    <Button x:Name="TestConnectionButton" 
                            Content="Test Connection" 
                            Click="TestConnectionButton_Click"
                            Padding="25,8" 
                            FontSize="14" 
                            FontWeight="Bold"
                            Background="{StaticResource PrimaryBrush}"
                            Foreground="White"
                            Cursor="Hand"
                            Margin="0,0,0,10" Width="180" Height="47"/>
                    <Button x:Name="StartAssessmentButton" 
                            Content="Start Assessment" 
                            Click="StartAssessmentButton_Click"
                            Padding="25,12" 
                            FontSize="14" 
                            FontWeight="Bold"
                            Background="{StaticResource PrimaryBrush}"
                            Foreground="White"
                            Cursor="Hand" Width="180" Height="47"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- Results Panel -->
        <GroupBox Grid.Row="2" Header="Assessment Results" Margin="0,0,0,15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Progress Bar -->
                <ProgressBar Grid.Row="0" x:Name="ProgressBar" 
                             Height="30" Margin="0,0,0,10"
                             Visibility="Collapsed"/>

                <!-- Results DataGrid -->
                <DataGrid Grid.Row="1" x:Name="ResultsDataGrid" 
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          GridLinesVisibility="All"
                          HeadersVisibility="Column"
                          SelectionMode="Single"
                          CanUserResizeColumns="True"
                          CanUserSortColumns="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Finding Title" Binding="{Binding FindingTitle}" Width="*" MinWidth="200">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextWrapping" Value="Wrap"/>
                                    <Setter Property="Margin" Value="5,2"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Details" Binding="{Binding Details}" Width="2*" MinWidth="300">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextWrapping" Value="Wrap"/>
                                    <Setter Property="Margin" Value="5,2"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Recommended Fix" Binding="{Binding RecommendedFix}" Width="2*" MinWidth="300">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextWrapping" Value="Wrap"/>
                                    <Setter Property="Margin" Value="5,2"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                    </DataGrid.Columns>
                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Status}" Value="FAIL">
                                    <Setter Property="Background" Value="#FFE8E8"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Status}" Value="WARN">
                                    <Setter Property="Background" Value="#FFF8E1"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Status}" Value="PASS">
                                    <Setter Property="Background" Value="#E8F5E9"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>
                </DataGrid>
            </Grid>
        </GroupBox>

        <!-- Status Bar -->
        <StatusBar Grid.Row="3" Height="35">
            <StatusBarItem>
                <TextBlock x:Name="StatusTextBlock" Text="Ready - Enter credentials to begin" FontWeight="Bold"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock x:Name="AccountCountTextBlock" Text="Accounts: 0"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock x:Name="FindingsCountTextBlock" Text="Findings: 0"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem HorizontalAlignment="Right">
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="ExportButtonCSV" Content="Export CSV" 
                            Click="ExportButtonCSV_Click" 
                            Padding="15,8"
                            IsEnabled="False"
                            Margin="0,0,10,0"/>
                    <Button x:Name="ExportButtonJson" Content="Export JSON" 
                            Click="ExportButtonJson_Click" 
                            Padding="15,8"
                            IsEnabled="False"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
        <TextBlock x:Name="lbl_instructions" 
                   Text="Instructions: Enter your AWS Access Key ID and Secret Access Key, then click 'Test Connection' to verify credentials. Enter the Audit Role ARN (use ACCOUNT_ID as placeholder - it will be replaced for each account). Click 'Start Assessment' to begin scanning all accounts in your AWS Organization." 
                   HorizontalAlignment="Left" 
                   Margin="730,0,0,0" 
                   VerticalAlignment="Center" 
                   Width="830" 
                   TextWrapping="Wrap"
                   FontSize="11"
                   Foreground="Gray"/>
    </Grid>
</Window>
